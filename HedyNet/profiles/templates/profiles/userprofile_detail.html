{% extends "profiles/base.html" %}
{% load markdown_deux_tags %}
{% load access_icons %}

{% block title %}Profile for: {{ user_profile.user.display_name }}{% endblock %}

{% block breadcrumbs %}
{{ block.super }}
{% with user_profile.user.username as username %}
<li class="current retain-capitalization">{% if user_profile.display_name %}{{ user_profile.display_name }} ({{ username }}){% else %}{{ username }}{% endif %}</li>
</ul>
{% endwith %}
{% endblock %}

{% block content %}
{% with user_profile.user.username as username %}
<div class="profile">
<div class="row">
<div class="columns medium-10">
<h1 class="left">Profile for {% if user_profile.display_name %}{{ user_profile.display_name }}{% else %}{{ username }}{% endif %} {{ user_profile.profile_access|access_icon }}</h1>
</div>
<div class="columns medium-2">
{% if can_edit %}
<a href="{% url "user_profile_edit" username=username %}" class="button right">Edit</a>
{% endif %}
</div>
</div>

{% if user_profile.is_member %}
<div class="panel member">
<section class="row">
<div class="columns">
{% if user_profile.became_member_on %}
<span>Member since: {{ user_profile.became_member_on }}</span>
{% else %}
<span>Member</span>
{% endif %}
</div>
</section>
</div>
{% endif %}

<section class="row">
<div class="columns">
{% if user_profile.display_name %}
{% include "foundation/infofield/basic.html" with item_title="Username" item=username %}
{% endif %}
{% if user_profile.legal_name %}
{% include "foundation/infofield/basic.html" with item_title="Legal name" item=user_profile.legal_name %}
{% endif %}

{% if preferred_phone %}
{% if user_profile.preferred_contact_method == "phone" %}
{% include "foundation/infofield/basic.html" with item_title="Phone (preferred)" item=preferred_phone.phone %}
{% else %}
{% include "foundation/infofield/basic.html" with item_title="Phone" item=preferred_phone.phone %}
{% endif %}
{% if preferred_phone.notes %}
<blockquote>{{ preferred_phone.notes|markdown }}</blockquote>
{% endif %}
{% endif %}

{% if preferred_email %}
{% if user_profile.preferred_contact_method == "email" %}
{% include "foundation/infofield/link.html" with item_title="Email (preferred)" item=preferred_email.email item_link="mailto:"|add:preferred_email.email %}
{% else %}
{% include "foundation/infofield/link.html" with item_title="Email" item=preferred_email.email item_link="mailto:"|add:preferred_email.email %}
{% endif %}
{% if preferred_email.notes %}
<blockquote>{{ preferred_email.notes|markdown }}</blockquote>
{% endif %}
{% endif %}

{% if preferred_address %}
{% if user_profile.preferred_contact_method == "address" %}
{% include "foundation/infofield/link.html" with item_title="Address (preferred)" item=preferred_address.address item_link="mailto:"|add:preferred_address.address %}
{% else %}
{% include "foundation/infofield/link.html" with item_title="Address" item=preferred_address.address item_link="mailto:"|add:preferred_address.address %}
{% endif %}
{% if preferred_address.notes %}
<blockquote>{{ preferred_email.notes|markdown }}</blockquote>
{% endif %}
{% endif %}

<a class="button right" href="{% url "user_contact" username=username %}">All contact information</a>
</div>
</section>

{% if user_profile.about or user_profile.public_about %}
<section class="row">
<div class="columns">
<h3>About Me</h3>
{{ user_profile.public_about|markdown }}

{% if user_profile.public_about and user_profile.about %}<hr />{% endif %}

{{ user_profile.about|markdown }}
</div>
</section>
{% endif %}

{% if external_sites %}
<section class="row">
<div class="columns">

<div class="row">
<div class="columns medium-10">
<h3>My Sites</h3>
</div>
<div class="columns medium-2">
{% if can_edit %}
<a href="{% url "user_profile_site_add" username=username %}" class="button tiny right">Add site</a>
{% endif %}
</div>
</div>

<dl>
{% for site in external_sites %}
<dt>
{% if site.link %}<a href="{{ site.link }}">{% endif %}{{ site.label }}{% if site.handle %}: {{ site.handle }}{% endif %}{% if site.link %}</a>{% endif %}
{% if can_edit %}<a class="right" href="{% url "user_profile_site_update" username=username pk=site.pk %}">Edit</a>{% endif %}
</dt>
{% if site.notes %}
<dd>{{ site.notes|markdown }}</dd>
{% endif %}
{% endfor %}
</dl>

</div>
</section>
{% else %}
{% if can_edit %}
<section class="row">
<div class="columns medium-10">
<h3>My Sites</h3>
</div>
<div class="columns medium-2">
{% if can_edit %}
<a href="{% url "user_profile_site_add" username=username %}" class="button right">Add site</a>
{% endif %}
</div>
</section>
{% endif %}
{% endif %}


{% if user_profile.dietary_considerations %}
<section class="row">
<div class="columns">
<h3>Dietary Considerations</h3>
{{ user_profile.dietary_considerations|markdown }}
</div>
</section>
{% endif %}

{% if user_profile.emergency_contact %}
<section class="row">
<div class="columns">
<h3>Emergency Contact</h3>
{{ user_profile.emergency_contact|markdown }}
</div>
</section>
{% endif %}

<div class="row">
<div class="columns">
<p><a href="{% url "memberdirectory" %}">Back to member directory</a></p>
</div>
</div>

</div>
{% endwith %}
{% endblock %}
